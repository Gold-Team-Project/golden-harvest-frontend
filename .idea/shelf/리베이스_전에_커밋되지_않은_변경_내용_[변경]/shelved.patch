Index: src/router/index.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>// src/router/index.js\r\nimport { createRouter, createWebHistory } from 'vue-router'\r\nimport { jwtDecode } from 'jwt-decode' // ✅ 라이브러리 임포트 확인 (없으면 npm install jwt-decode)\r\n\r\nimport UserDefaultLayout from \"@/layouts/user/UserDefaultLayout.vue\";\r\nimport InquiryListView from \"@/views/inquiry/user/InquiryListView.vue\";\r\nimport AdminInquiryListView from \"@/views/inquiry/admin/AdminInquiryListView.vue\";\r\nimport InquiryCreateView from \"@/views/inquiry/user/InquiryCreateView.vue\";\r\nimport AdminDefaultLayout from \"@/layouts/admin/AdminDefaultLayout.vue\";\r\nimport AdminOrderListView from \"@/views/orderlist/AdminOrderListView.vue\";\r\nimport AdminOrderDetailView from \"@/views/orderlist/AdminOrderDetailView.vue\";\r\nimport MasterDataList from \"@/views/masterdata/MasterDataList.vue\";\r\nimport MasterDataDetail from \"@/views/masterdata/MasterDataDetail.vue\";\r\nimport MasterDataEdit from \"@/views/masterdata/MasterDataEdit.vue\";\r\nimport AdminNotificationListView from \"@/views/notification/admin/AdminNotificationListView.vue\";\r\nimport PerchaseOrderListView from \"@/views/perchaseOrder/PerchaseOrderListView.vue\";\r\nimport LotListView from \"@/views/lot/LotListView.vue\";\r\nimport DiscardRegisterView from \"@/views/discard/DiscardRegisterView.vue\";\r\nimport DiscardListView from \"@/views/discard/DiscardListView.vue\";\r\nimport OrderHistoryView from \"@/views/orderHistory/OrderHistoryView.vue\";\r\nimport OrderHistoryDetailView from \"@/views/orderHistory/OrderHistoryDetailView.vue\";\r\nimport CartView from \"@/views/cart/CartView.vue\";\r\nimport OrderView from \"@/views/order/OrderView.vue\";\r\nimport OrderDetailView from \"@/views/order/OrderDetailView.vue\";\r\nimport Login from \"@/views/login/Login.vue\";\r\nimport Signup from \"@/views/signup/Signup.vue\";\r\nimport Password from \"@/views/password/Password.vue\";\r\nimport Mypage from \"@/views/mypage/Mypage.vue\";\r\nimport UserApproval from \"@/views/userapproval/UserApproval.vue\";\r\n\r\nconst routes = [\r\n    {\r\n        path: '/login',\r\n        name: \"login\",\r\n        component: Login,\r\n    },\r\n    {\r\n        path: '/signup',\r\n        name: \"signup\",\r\n        component: Signup,\r\n    },\r\n    {\r\n        path: '/password',\r\n        name: \"password\",\r\n        component: Password,\r\n    },\r\n    {\r\n        path: '/',\r\n        component: UserDefaultLayout,\r\n        children: [\r\n            {\r\n                path: 'order',\r\n                name: 'Order',\r\n                component: OrderView,\r\n                meta: { title: '주문' }\r\n            },\r\n            {\r\n                path: 'order/:id',\r\n                name: 'ProductDetail',\r\n                component: OrderDetailView,\r\n                meta: { title: '주문 / 상품상세' }\r\n            },\r\n            {\r\n                path: 'cart',\r\n                name: 'Cart',\r\n                component: CartView,\r\n                meta: { title: '장바구니' }\r\n            },\r\n            {\r\n                path: 'order-history',\r\n                name: \"Invoice\",\r\n                component: OrderHistoryView,\r\n                meta: { title: '영수증'}\r\n            },\r\n            {\r\n                path: 'order-history/:id',\r\n                name: 'OrderDetail',\r\n                component: OrderHistoryDetailView,\r\n                meta: { title: '영수증 / 영수증 상세 내역' }\r\n            },\r\n            {\r\n                path: 'inquiries',\r\n                name: \"inquiryList\",\r\n                component: InquiryListView,\r\n                meta: { title: '설정 / 문의 내역'}\r\n            },\r\n            {\r\n                path: 'inquiries/create',\r\n                name: \"inquiryCreate\",\r\n                component: InquiryCreateView,\r\n                meta: { title: '설정 / 문의 내역 / 문의 등록 '}\r\n            },\r\n            {\r\n                path: 'mypage',\r\n                name: \"mypage\",\r\n                component: Mypage,\r\n                meta: { title: '마이페이지 / 내정보 수정 '}\r\n            },\r\n        ],\r\n    },\r\n    {\r\n        path: '/admin',\r\n        component: AdminDefaultLayout,\r\n        meta: { requiresAdmin: true }, // ✅ 이 부모가 있는 자식들은 모두 가드에 걸립니다.\r\n        children: [\r\n            {\r\n                path: 'orders',\r\n                name: 'adminOrderList',\r\n                component: AdminOrderListView,\r\n                meta: { title: '거래 관리 / 고객 주문 목록' },\r\n            },\r\n            {\r\n                path: 'orders/:id',\r\n                name: 'adminOrderDetail',\r\n                component: AdminOrderDetailView,\r\n                meta: { title: '거래 관리 / 주문 상세' },\r\n            },\r\n            {\r\n                path: 'inquiries',\r\n                name: 'adminInquiryList',\r\n                component: AdminInquiryListView,\r\n                meta: { title: '관리자 / 문의 관리' },\r\n            },\r\n            {\r\n                path: 'masterData',\r\n                name: 'adminMasterDataList',\r\n                component: MasterDataList,\r\n                meta: { title: '홈 / 마스터 데이터 / 품목 관리' },\r\n            },\r\n            {\r\n                path: 'masterData/:skuNo',\r\n                name: 'adminMasterDataDetail',\r\n                component: MasterDataDetail,\r\n                meta: { title: '홈 / 마스터 데이터 / 품목 관리 / 품목 상세 정보' },\r\n            },\r\n            {\r\n                path: 'masterData/edit/:skuNo',\r\n                name: 'MasterEdit',\r\n                component: MasterDataEdit\r\n            },\r\n            {\r\n                path: 'notifications',\r\n                name: 'adminNotification',\r\n                component: AdminNotificationListView,\r\n                meta: { title: '알림' },\r\n            },\r\n            {\r\n                path: 'perchaseOrder',\r\n                name: 'perchaseOrder',\r\n                component: PerchaseOrderListView,\r\n                meta: { title: '알림' },\r\n            },\r\n            {\r\n                path: 'lots',\r\n                name: 'adminLotList',\r\n                component: LotListView,\r\n                meta: { title: '홈 / LOT 관리 / LOT 리스트' },\r\n            },\r\n            {\r\n                path: 'discard/register',\r\n                name: 'adminDiscardRegister',\r\n                component: DiscardRegisterView,\r\n                meta: { title: '홈 / 재고 관리 / 폐기 등록' },\r\n            },\r\n            {\r\n                path: 'discard/list',\r\n                name: 'adminDiscardList',\r\n                component: DiscardListView,\r\n                meta: { title: '홈 / 재고 관리 / 폐기 내역' },\r\n            },\r\n            {\r\n                path: 'approval',\r\n                name: 'adminMemberList',\r\n                component: UserApproval,\r\n                meta: { title: '홈 / 재고 관리 / 폐기 내역' },\r\n            },\r\n        ]\r\n    }\r\n]\r\n\r\n// 라우터 생성\r\nconst router = createRouter({\r\n    history: createWebHistory(),\r\n    routes\r\n})\r\n\r\n// 라우터 가드 작성\r\nrouter.beforeEach((to, from, next) => {\r\n    const token = localStorage.getItem('accessToken');\r\n\r\n    // to.matched를 통해 부모 중 하나라도 requiresAdmin이 있는지 확인합니다.\r\n    const isRequiresAdmin = to.matched.some(record => record.meta.requiresAdmin);\r\n\r\n    if (isRequiresAdmin) {\r\n        if (!token) {\r\n            alert('관리자 로그인이 필요한 페이지입니다.');\r\n            return next('/login');\r\n        }\r\n\r\n        try {\r\n            const decoded = jwtDecode(token);\r\n            // 백엔드 Role 값(ROLE_ADMIN)과 일치하는지 확인\r\n            if (decoded.role !== 'ROLE_ADMIN') {\r\n                alert('접근 권한이 없습니다.');\r\n                return next('/');\r\n            }\r\n            next(); // 관리자라면 통과\r\n        } catch (error) {\r\n            console.error('JWT Decode Error:', error);\r\n            localStorage.removeItem('accessToken');\r\n            next('/login');\r\n        }\r\n    } else {\r\n        next(); // 일반 페이지는 통과\r\n    }\r\n});\r\n\r\nexport default router;
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/router/index.js b/src/router/index.js
--- a/src/router/index.js	(revision e74fb26e32f3494c9e43310fe829144d0a0014be)
+++ b/src/router/index.js	(date 1769667418670)
@@ -101,7 +101,7 @@
     {
         path: '/admin',
         component: AdminDefaultLayout,
-        meta: { requiresAdmin: true }, // ✅ 이 부모가 있는 자식들은 모두 가드에 걸립니다.
+        meta: { requiresAdmin: false }, // ✅ 이 부모가 있는 자식들은 모두 가드에 걸립니다.
         children: [
             {
                 path: 'orders',
